{
  "version": 3,
  "sources": ["../../@vaadin/flow-frontend/flow-component-renderer.js"],
  "sourcesContent": ["import '@polymer/polymer/lib/elements/dom-if.js';\r\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\r\nimport { Debouncer } from '@polymer/polymer/lib/utils/debounce.js';\r\nimport { idlePeriod } from '@polymer/polymer/lib/utils/async.js';\r\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\r\n\r\nclass FlowComponentRenderer extends PolymerElement {\r\n  static get template() {\r\n    return html`\r\n      <style>\r\n        :host {\r\n          animation: 1ms flow-component-renderer-appear;\r\n        }\r\n\r\n        @keyframes flow-component-renderer-appear {\r\n          to {\r\n            opacity: 1;\r\n          }\r\n        }\r\n      </style>\r\n      <slot></slot>\r\n    `;\r\n  }\r\n\r\n  static get is() {\r\n    return 'flow-component-renderer';\r\n  }\r\n  static get properties() {\r\n    return {\r\n      nodeid: Number,\r\n      appid: String,\r\n    };\r\n  }\r\n  static get observers() {\r\n    return ['_attachRenderedComponentIfAble(appid, nodeid)'];\r\n  }\r\n\r\n  ready() {\r\n    super.ready();\r\n    this.addEventListener('click', function (event) {\r\n      if (\r\n        this.firstChild &&\r\n        typeof this.firstChild.click === 'function' &&\r\n        event.target === this\r\n      ) {\r\n        event.stopPropagation();\r\n        this.firstChild.click();\r\n      }\r\n    });\r\n    this.addEventListener('animationend', this._onAnimationEnd);\r\n  }\r\n\r\n  _asyncAttachRenderedComponentIfAble() {\r\n    this._debouncer = Debouncer.debounce(this._debouncer, idlePeriod, () =>\r\n      this._attachRenderedComponentIfAble()\r\n    );\r\n  }\r\n\r\n  _attachRenderedComponentIfAble() {\r\n    if (!this.nodeid || !this.appid) {\r\n      return;\r\n    }\r\n    const renderedComponent = this._getRenderedComponent();\r\n    if (this.firstChild) {\r\n      if (!renderedComponent) {\r\n        this._asyncAttachRenderedComponentIfAble();\r\n      } else if (this.firstChild !== renderedComponent) {\r\n        this.replaceChild(renderedComponent, this.firstChild);\r\n        this._defineFocusTarget();\r\n        this.onComponentRendered();\r\n      } else {\r\n        this._defineFocusTarget();\r\n        this.onComponentRendered();\r\n      }\r\n    } else {\r\n      if (renderedComponent) {\r\n        this.appendChild(renderedComponent);\r\n        this._defineFocusTarget();\r\n        this.onComponentRendered();\r\n      } else {\r\n        this._asyncAttachRenderedComponentIfAble();\r\n      }\r\n    }\r\n  }\r\n\r\n  _getRenderedComponent() {\r\n    try {\r\n      return window.Vaadin.Flow.clients[this.appid].getByNodeId(this.nodeid);\r\n    } catch (error) {\r\n      console.error(\r\n        'Could not get node %s from app %s',\r\n        this.nodeid,\r\n        this.appid\r\n      );\r\n      console.error(error);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  onComponentRendered() {\r\n    // subclasses can override this method to execute custom logic on resize\r\n  }\r\n\r\n  /* Setting the `focus-target` attribute to the first focusable descendant\r\n  starting from the firstChild necessary for the focus to be delegated\r\n  within the flow-component-renderer when used inside a vaadin-grid cell  */\r\n  _defineFocusTarget() {\r\n    var focusable = this._getFirstFocusableDescendant(this.firstChild);\r\n    if (focusable !== null) {\r\n      focusable.setAttribute('focus-target', 'true');\r\n    }\r\n  }\r\n\r\n  _getFirstFocusableDescendant(node) {\r\n    if (this._isFocusable(node)) {\r\n      return node;\r\n    }\r\n    if (node.hasAttribute && (node.hasAttribute('disabled') || node.hasAttribute('hidden'))) {\r\n      return null;\r\n    }\r\n    if (!node.children) {\r\n      return null;\r\n    }\r\n    for (var i = 0; i < node.children.length; i++) {\r\n      var focusable = this._getFirstFocusableDescendant(node.children[i]);\r\n      if (focusable !== null) {\r\n        return focusable;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _isFocusable(node) {\r\n    if (\r\n      node.hasAttribute &&\r\n      typeof node.hasAttribute === 'function' &&\r\n      (node.hasAttribute('disabled') || node.hasAttribute('hidden'))\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    return node.tabIndex === 0;\r\n  }\r\n\r\n  _onAnimationEnd(e) {\r\n    // ShadyCSS applies scoping suffixes to animation names\r\n    // To ensure that child is attached once element is unhidden\r\n    // for when it was filtered out from, eg, ComboBox\r\n    // https://github.com/vaadin/vaadin-flow-components/issues/437\r\n    if (e.animationName.indexOf('flow-component-renderer-appear') === 0) {\r\n      this._attachRenderedComponentIfAble();\r\n    }\r\n  }\r\n}\r\nwindow.customElements.define(FlowComponentRenderer.is, FlowComponentRenderer);\r\n"],
  "mappings": "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",
  "names": []
}
